(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{283:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>l});var s=r(5155),a=r(2115),n=r(7565),i=r(9186);let o=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(!0),[m,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await n.N.auth.getSession();u(t),l(null!=(e=null==t?void 0:t.user)?e:null),h(!1)})();let{data:{subscription:e}}=n.N.auth.onAuthStateChange(async(e,t)=>{var r;u(t),l(null!=(r=null==t?void 0:t.user)?r:null),h(!1),"SIGNED_IN"===e&&(null==t?void 0:t.user)&&await _(t.user)});return()=>e.unsubscribe()},[]);let _=async e=>{try{let{data:t,error:r}=await n.N.from("users").select("id").eq("id",e.id).single();if(r&&"PGRST116"!==r.code)throw new i.a$("Failed to check existing user profile");if(t)return;let{error:s}=await n.N.from("users").insert([{id:e.id,email:e.email,daily_goal:8,focus_duration:25,short_break_duration:5,long_break_duration:15,long_break_interval:4,auto_start_breaks:!1,auto_start_sessions:!1,sound_enabled:!0,notifications_enabled:!0,theme:"dark"}]);if(s)throw new i.a$("Failed to create user profile")}catch(t){let e=(0,i.H4)(t);f(e.message),console.error("Error creating user profile:",e)}},x=async(e,t)=>{let{error:r}=await n.N.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});return{error:r}},b=async(e,t)=>{let{error:r}=await n.N.auth.signInWithPassword({email:e,password:t});return{error:r}},p=async()=>{let{error:e}=await n.N.auth.signOut();return{error:e}},g=async e=>{let{error:t}=await n.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});return{error:t}};return(0,s.jsx)(o.Provider,{value:{user:r,session:c,loading:d,error:m,signUp:x,signIn:b,signOut:p,resetPassword:g,clearError:()=>f(null)},children:t})}function c(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},347:()=>{},3346:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var s=r(5155),a=r(2115);let n=(0,r(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var i=r(3904);class o extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){if(this.state.hasError){let e=()=>{this.setState({hasError:!1})};if(this.props.fallback){let t=this.props.fallback;return(0,s.jsx)(t,{error:this.state.error,reset:e})}return(0,s.jsx)(l,{error:this.state.error,reset:e})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}function l(e){let{error:t,reset:r}=e;return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,s.jsx)("div",{className:"max-w-md w-full mx-auto p-6",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20 mb-4",children:(0,s.jsx)(n,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:t.message||"An unexpected error occurred"}),(0,s.jsxs)("button",{onClick:r,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800",children:[(0,s.jsx)(i.A,{className:"h-4 w-4 mr-2"}),"Try again"]})]})})})}let c=o},3904:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4147:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},7565:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var s=r(5647);let a={SUPABASE_SERVICE_ROLE_KEY:r(9509).env.SUPABASE_SERVICE_ROLE_KEY},n={NEXT_PUBLIC_SUPABASE_URL:"https://hyeupxvitjxlnimzjclo.supabase.co",NEXT_PUBLIC_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5ZXVweHZpdGp4bG5pbXpqY2xvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0OTk3MDcsImV4cCI6MjA2ODA3NTcwN30.KHiiKOFLvzoIHtDZVHPFplmysm89hG9vcZZT1xOwCWM",...a},i=n.NEXT_PUBLIC_SUPABASE_URL,o=n.NEXT_PUBLIC_SUPABASE_ANON_KEY,l=(0,s.UU)(i,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},7589:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,4147,23)),Promise.resolve().then(r.t.bind(r,8489,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,9424)),Promise.resolve().then(r.bind(r,3346))},8489:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9186:(e,t,r)=>{"use strict";r.d(t,{H4:()=>n,a$:()=>a});class s extends Error{constructor(e,t,r=500){super(e),this.code=t,this.statusCode=r,this.name="AppError"}}class a extends s{constructor(e){super(e,"DATABASE_ERROR",500),this.name="DatabaseError"}}function n(e){return e instanceof s?e:e instanceof Error?new s(e.message,"UNKNOWN_ERROR"):new s("An unknown error occurred","UNKNOWN_ERROR")}},9424:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var s=r(5155),a=r(283);function n(e){let{children:t}=e;return(0,s.jsx)(a.O,{children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[896,800,441,684,358],()=>t(7589)),_N_E=e.O()}]);